@page "/children-list"
@inject ChildServices service

<h3>Children's List</h3>

<table class="table table-striped table-hover ">
    <thead>
        <tr>
            <th>#</th>
            <th>First Name</th>
            <th>Middle Name</th>
            <th>Last Name</th>
            <th>Birthday</th>
            <th>Diet</th>
            <th>Allergies</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var child in Children)
        {
            <tr>
                <td>@child.ChildId</td>
                <td>@child.FirstName</td>
                <td>@child.MidName</td>
                <td>@child.LastName</td>
                <td>@child.Birthday</td>
                <td>@child.DietRestrictions</td>
                <td>@child.Allergies</td>
                <td><button class="btn btn-danger" onclick="(() => DeleteChild(child))">Delete</button></td>
            </tr>
        }
    </tbody>
</table>

@code {
    private List<Child> Children = new List<Child>();
    protected override async Task OnInitializedAsync()
    {
        if(Children.Count == 0)
        {
            
        }
        await RefreshChildren();
    }

    private async Task RefreshChildren()
    {
        Children = await service.GetChildAsync();
    }

    private async Task DeleteChild(Child child)
    {
        await service.DeleteChildAsync(child);
        await RefreshChildren();
    }
}
